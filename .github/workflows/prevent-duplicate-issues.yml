name: Prevent Duplicate Issues

on:
  issues:
    types: [opened]

jobs:
  check-duplicate:
    runs-on: ubuntu-latest
    steps:
      - name: ì¤‘ë³µ ì œëª© ê²€ìƒ‰
        uses: actions/github-script@v6
        with:
          script: |
            const title = context.payload.issue.title;
            // ë™ì¼ repo ë‚´ ì—´ë¦°(issue) ì´ìŠˆ ì¤‘ ê°™ì€ ì œëª© ê²€ìƒ‰
            const { data: search } = await github.rest.search.issuesAndPullRequests({
              q: `repo:${context.repo.owner}/${context.repo.repo} is:issue is:open in:title "${title}"`
            });
            if (search.total_count > 1) {
              // ê²½ê³  ì½”ë©˜íŠ¸
              await github.rest.issues.createComment({
                ...context.issue,
                body: 'ğŸš¨ ë™ì¼í•œ ì œëª©ì˜ ì´ìŠˆê°€ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤. ì¤‘ë³µ ì—¬ë¶€ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.'
              });
              // (ì„ íƒ) ì—´ë ¤ ìˆëŠ” ì¤‘ë³µ ì´ìŠˆ ìë™ ë‹«ê¸°
              // await github.rest.issues.update({ ...context.issue, state: 'closed' });
            }
